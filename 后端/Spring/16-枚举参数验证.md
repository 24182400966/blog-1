# 枚举参数验证

## 使用

```java
@Data
public class PmsBrandStatusParam {

    @ApiModelProperty(value = "ID", required = true)
    @NotNull(message = "品牌ID不能为空")
    private Long id;

    @ApiModelProperty(value = "是否为品牌制造商：0->不是；1->是", required = true)
    @FlagValidator(value = {"0","1"}, message = "厂家状态不正确")
    private Integer factoryStatus;

    @ApiModelProperty(value = "是否显示", required = true)
    @FlagValidator(value = {"0","1"}, message = "显示状态不正确")
    private Integer showStatus;

}
```

## 实现

需要接口 `FlagValidator` 和具体实现类 `FlagValidatorClass`：

```java
package com.chanshiyu.moemall.admin.validator;

import javax.validation.Constraint;
import javax.validation.Payload;
import java.lang.annotation.*;

/**
 * @author SHIYU
 * @date 2019/10/16 10:36
 * @description 验证状态是否在指定范围内的注解
 */
@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.FIELD, ElementType.PARAMETER})
@Constraint(validatedBy = FlagValidatorClass.class)
public @interface FlagValidator {
    String[] value() default {};

    String message() default "flag is not found";

    Class<?>[] groups() default {};

    Class<? extends Payload>[] payload() default {};
}
```

```java
package com.chanshiyu.moemall.admin.validator;

import javax.validation.ConstraintValidator;
import javax.validation.ConstraintValidatorContext;

/**
 * @author SHIYU
 * @date 2019/10/16 10:36
 * @description 状态标记校验器
 */
public class FlagValidatorClass implements ConstraintValidator<FlagValidator, Integer> {
    private String[] values;

    @Override
    public void initialize(FlagValidator flagValidator) {
        this.values = flagValidator.value();
    }

    @Override
    public boolean isValid(Integer value, ConstraintValidatorContext constraintValidatorContext) {
        boolean isValid = false;
        if (value == null) {
            // 当状态为空时使用默认值
            return true;
        }
        for (String val : values) {
            if (val.equals(String.valueOf(value))) {
                isValid = true;
                break;
            }
        }
        return isValid;
    }
}
```
